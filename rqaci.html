<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>
		RQACI- estimate confidence bounds of recurrence-based complexity measures	</title>
	<meta name="author" content="stefan schinkel" />
	<meta name="Keywords" content=" Nonlinear Dynamics Group, EEG, ERP, RQA" />
	<meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
	<meta name="robots" content="index" />
	<link rel="stylesheet" type="text/css" href="css/style.css" />
	<link rel="shortcut icon" href="img/favicon.ico" />


<!-- lightbox //-->
<script src="js/jquery-1.7.2.min.js" type="text/javascript"></script>
<script src="js/lightbox.js" type="text/javascript"></script>
<link href="css/lightbox.css" rel="stylesheet" />

<!-- google analytics //-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-31380322-1', 'auto');
  ga('send', 'pageview');

</script>
</head>
<body>


<div class="banner">
	<p>
<!-- 		<img src="img/freebsd.png" style="float:none" alt="A daemon"
		title="I'm a dang sight cuter than that penguin with the Huge Butt."/>
		<br /> -->
		<a href="index.html">Home</a> 	<br />
		<a href="#about">About</a>		<br />
		<a href="#content">Contents</a> <br />
		<a href="#requirements">Requirements</a> 	<br />
		<a href="#example">Example</a>			<br />
		<a href="#download">Download</a>		<br />
		<a href="#questions">Questions?</a>		<br />
	</p>
</div>


<div class="content">
<h3 class="subheading">
	RQACI
</h3>

<h4 class="subheading"> About:</h4>	<a name="about"></a>
<p> RQACI - routines to estimate confidence bounds of recurrence-based
complexity measures</p>

<p> If you use this software for data analysis and publication please cite: <span class="bold">S. Schinkel</span>, N. Marwan, O. Dimigen and J. Kurths (2009) <em>Confidence bounds of recurrence-based complexity measures</em>,
<a href="http://www.elsevier.com/locate/pla">Physics Letters A</a>, 373(26), pp. 2245-2250. <a href="http://dx.doi.org/10.1016/j.physleta.2009.04.045">DOI:10.1016/j.physleta.2009.04.045</a>
</p>

<h4 class="subheading"> Contents:</h4><a name="contents"></a>

<dl>
	<dt>rqaci.m</dt>
	<dd> - The core routine</dd>
	<dt>lineDists.m</dt>
	<dd> - function to extract lines structures from RPs</dd>
	<dt>bootstrap.m</dt>
	<dd> - function to bootstrap a distribution</dd>
	<dt>ciplot.m</dt>
	<dd> - routine for plot confidence intervals</dd>
	<dt>cicompare.m</dt>
	<dd> - routine for comparing overlap confidence intervals</dd>
	<dt>rqaciGUI.m</dt>
	<dd> - graphical frontend (GUI) to rqaci</dd>
	<dt>rqaciGUILayout.m</dt>
	<dd> - layout of the GUI</dd>
</dl>

<h4 class="subheading"> Requirements:</h4><a name="requirements"></a>
<ul>
	<li><a href="http://www.mathworks.com/products/matlab/">MATLAB</a>
	(I use 2007, 2010a and 2010b so those should work, as well as any recent version)</li>
	<li>the <a href="http://tocsy.pik-potsdam.de/CRPtoolbox/">CRPtoolbox </a>
	(to construct RPs) -- unless you do this yourself</li>
	<li>a function to estimate percentiles -- either from the Statistics Toolbox of MATLAB
	or use the stand-in below</li>


</ul>


<h4 class="subheading"> Example:</h4><a name="example"></a>
<a href="img/rqaci.png" rel="lightbox" title="the GUI in action">
<img src="img/rqaci.png" width="400" alt="The GUI for rqaci" /></a>

<p> As a prototypical example we will use the logistic map for different parameters.<br />
To compute the logistic map, save the function below so that it is accessible for MATLAB.</p>
<pre>
function out = logistic(varargin)

% get params
varargin{4} =[];
if ~isempty(varargin{1}), x0=varargin{1};else x0=rand;end
if ~isempty(varargin{2}), a=varargin{2};else a=3.5;end
if ~isempty(varargin{3}), n=varargin{3};else n=100;end

out = zeros( n, 1 );
out(1) = x0;
for i = 1:n-1
	out(i+1) = a*out(i)*(1-out(i));
end

</pre>

<p> Now we compute the logistic map for 2 cases: <br />
Random (x) and periodic with a random part (y).
The transients are removed.</p>
<pre>

% random case
x = logistic(rand(1),3.89,5000);
x = x(end-900+1:end);

% transition case
y1 = logistic(rand(1),3.40,5000); % periodic
y2 = logistic(rand(1),3.89,5000); % random
y3 = logistic(rand(1),3.40,5000); % periodic

% concat segments
y = cat(1, y1(end-300+1:end),y2(end-300+1:end),y3(end-300+1:end));

% and add some noise
y = y + rand(size(y)) * .2;
x = x + rand(size(x)) * .2;
</pre>
<p> Plot the data just to have a look at it</p>

<pre>
subplot(2,1,1);
plot(y,'r');
subplot(2,1,2);
plot(x,'b');
</pre>

<p> Setup parameters</p>
<pre>
tau = 7;
dim = 6;
tresh = .4;
norm = 'rr'; % fixed recurrence rate
win = 100;
step = 10;
</pre>
<p> Compute RPs in a windowed fashion and estimate complexity measures <br /> and
their  confindence intervals for each window</p>
<pre>
for iFrame = 1:step:length(x)-win
	rpX = crp(x(iFrame:iFrame+win),dim,tau,thresh,norm,'sil');
	rpY = crp(y(iFrame:iFrame+win),dim,tau,thresh,norm,'sil');
	[valX(iFrame,:) ciX(iFrame,:,:)] = rqaci(rpX,750,1);
	[valY(iFrame,:) ciY(iFrame,:,:)] = rqaci(rpY,750,1);
end
</pre>
<p>Now plot the confidence intervals</p>
<pre>
figure;
ciplot(ciX(1:step:end,1,:),'b')
ciplot(ciY(1:step:end,1,:),'r')
</pre>
<p> This can be done using the GUI by calling (see screenshot)</p>
<pre>
rqaciGUI(x,y)
</pre>

<h4 class="subheading"> Download:</h4><a name="download"></a>
	<a href="download/rqaci.zip">rqaci.zip</a>&nbsp;&nbsp;&nbsp;version:bb5a...f838 &nbsp;
	&nbsp;&nbsp;&nbsp;md5: b3978a041cecad1ffe811f99f86f7f99 <br />
	<a href="download/prctile.m">prctile.m</a>&nbsp;&nbsp;&nbsp;version:bb5a...f838 &nbsp;
	&nbsp;&nbsp;&nbsp;md5: d8a7d1393edc437befcfd1d7b7ee0959 <br />
	(stand-in for prctile.m if Statistics Toolbox is not installed -- found on the net and modified by me)<br />

<h4 class="subheading"> Questions/Requests? :</h4>	<a name="questions"></a>

<ins>
<span style="display:inline;" id="ophyscator"></span>
<script type="text/javaScript">

var a = new Array('d','r','g','e','i','g','@','o','e','r','m','.','l','a');
var b = new Array('g','d','r','r','e','@','a','l','m','g','i','.','e','o');
var str = "<a href='mailto:"+a[10]+a[13]+a[4]+a[12]+a[6]+a[0]+a[1]+a[3]+a[8]+a[2]+a[11]+a[7]+a[9]+a[5]+"'>"+b[8]+b[6]+b[10]+b[7]+b[5]+b[1]+b[2]+b[4]+b[12]+b[9]+b[11]+b[13]+b[3]+b[0]+"<\/a>";

document.getElementById('ophyscator').innerHTML = str;
</script>
<noscript>
<p>Sorry, you need to have JavaScript enabled to get the mail address</p></noscript>
</ins>



<p style="text-align: right; font-size: smaller;"><a href="#top">Top</a></p>
</div>

<div style="text-align: center;">
	<hr style="width: 80%;" />
	<hr style="width: 65%;" />
Last modified 04/24/2015
</div>

<p style="position: absolute;bottom: .05em;right: .3em; position: fixed;">
<a href="https://github.com/stefanSchinkel" style="text-decoration:none;">
	<img style="border:0;width:88px;height:36px" src="img/GitHubLogo.png" alt="GitHub"
		title="Find me on github"/></a><br />


</p>

</body>
</html>
